<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://www.cs.york.ac.uk/fp/darcs/hscolour/ -->
<title>Haskell Code by HsColour</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="(line1)"></a><span class='keyword'>module</span> <span class='conid'>Turbinado</span><span class='varop'>.</span><span class='conid'>Utility</span><span class='varop'>.</span><span class='conid'>General</span> <span class='keyword'>where</span>
<a name="(line2)"></a>
<a name="(line3)"></a><span class='keyword'>import</span> <span class='conid'>Data</span><span class='varop'>.</span><span class='conid'>List</span>
<a name="(line4)"></a><span class='keyword'>import</span> <span class='conid'>Data</span><span class='varop'>.</span><span class='conid'>Maybe</span>
<a name="(line5)"></a>
<a name="(line6)"></a><span class='comment'>--</span>
<a name="(line7)"></a><span class='comment'>-- * Utility.General</span>
<a name="(line8)"></a><span class='comment'>--</span>
<a name="(line9)"></a>
<a name="(line10)"></a><a name="replace"></a><span class='comment'>-- | Replaces all instances of a value in a list by another value.</span>
<a name="(line11)"></a><span class='varid'>replace</span> <span class='keyglyph'>::</span> <span class='conid'>Eq</span> <span class='varid'>a</span> <span class='keyglyph'>=&gt;</span>
<a name="(line12)"></a>           <span class='varid'>a</span>   <span class='comment'>-- ^ Value to look for</span>
<a name="(line13)"></a>        <span class='keyglyph'>-&gt;</span> <span class='varid'>a</span>   <span class='comment'>-- ^ Value to replace it with</span>
<a name="(line14)"></a>        <span class='keyglyph'>-&gt;</span> <span class='keyglyph'>[</span><span class='varid'>a</span><span class='keyglyph'>]</span> <span class='comment'>-- ^ Input list</span>
<a name="(line15)"></a>        <span class='keyglyph'>-&gt;</span> <span class='keyglyph'>[</span><span class='varid'>a</span><span class='keyglyph'>]</span> <span class='comment'>-- ^ Output list</span>
<a name="(line16)"></a><span class='varid'>replace</span> <span class='varid'>x</span> <span class='varid'>y</span> <span class='keyglyph'>=</span> <span class='varid'>map</span> <span class='layout'>(</span><span class='keyglyph'>\</span><span class='varid'>z</span> <span class='keyglyph'>-&gt;</span> <span class='keyword'>if</span> <span class='varid'>z</span> <span class='varop'>==</span> <span class='varid'>x</span> <span class='keyword'>then</span> <span class='varid'>y</span> <span class='keyword'>else</span> <span class='varid'>z</span><span class='layout'>)</span>
<a name="(line17)"></a>
<a name="(line18)"></a><a name="maybeRead"></a><span class='varid'>maybeRead</span> <span class='keyglyph'>::</span> <span class='conid'>Read</span> <span class='varid'>a</span> <span class='keyglyph'>=&gt;</span> <span class='conid'>String</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>Maybe</span> <span class='varid'>a</span>
<a name="(line19)"></a><span class='varid'>maybeRead</span> <span class='keyglyph'>=</span> <span class='varid'>fmap</span> <span class='varid'>fst</span> <span class='varop'>.</span> <span class='varid'>listToMaybe</span> <span class='varop'>.</span> <span class='varid'>reads</span>
<a name="(line20)"></a>
<a name="(line21)"></a><a name="lookupOrNil"></a><span class='comment'>-- | Same as 'lookup' specialized to strings, but </span>
<a name="(line22)"></a><span class='comment'>--   returns the empty string if lookup fails.</span>
<a name="(line23)"></a><span class='varid'>lookupOrNil</span> <span class='keyglyph'>::</span> <span class='conid'>String</span> <span class='keyglyph'>-&gt;</span> <span class='keyglyph'>[</span><span class='layout'>(</span><span class='conid'>String</span><span class='layout'>,</span><span class='conid'>String</span><span class='layout'>)</span><span class='keyglyph'>]</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>String</span>
<a name="(line24)"></a><span class='varid'>lookupOrNil</span> <span class='varid'>n</span> <span class='keyglyph'>=</span> <span class='varid'>fromMaybe</span> <span class='str'>""</span> <span class='varop'>.</span> <span class='varid'>lookup</span> <span class='varid'>n</span>
<a name="(line25)"></a>
<a name="(line26)"></a><a name="each"></a><span class='varid'>each</span> <span class='keyglyph'>::</span> <span class='keyglyph'>[</span><span class='varid'>a</span><span class='keyglyph'>]</span> <span class='keyglyph'>-&gt;</span> <span class='layout'>(</span><span class='varid'>a</span> <span class='keyglyph'>-&gt;</span> <span class='varid'>b</span><span class='layout'>)</span> <span class='keyglyph'>-&gt;</span> <span class='keyglyph'>[</span><span class='varid'>b</span><span class='keyglyph'>]</span>
<a name="(line27)"></a><span class='varid'>each</span> <span class='varid'>l</span> <span class='varid'>f</span> <span class='keyglyph'>=</span> <span class='varid'>map</span> <span class='varid'>f</span> <span class='varid'>l</span>
</pre></body>
</html>
