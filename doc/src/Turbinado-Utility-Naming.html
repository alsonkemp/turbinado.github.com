<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://www.cs.york.ac.uk/fp/darcs/hscolour/ -->
<title>Haskell Code by HsColour</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="(line1)"></a><span class='keyword'>module</span> <span class='conid'>Turbinado</span><span class='varop'>.</span><span class='conid'>Utility</span><span class='varop'>.</span><span class='conid'>Naming</span> <span class='keyword'>where</span>
<a name="(line2)"></a>
<a name="(line3)"></a><span class='keyword'>import</span> <span class='conid'>Data</span><span class='varop'>.</span><span class='conid'>Char</span>
<a name="(line4)"></a><span class='keyword'>import</span> <span class='conid'>Data</span><span class='varop'>.</span><span class='conid'>List</span>
<a name="(line5)"></a>
<a name="(line6)"></a><span class='comment'>--</span>
<a name="(line7)"></a><span class='comment'>-- * Turbinado Utility functions for Naming </span>
<a name="(line8)"></a><span class='comment'>--</span>
<a name="(line9)"></a>
<a name="(line10)"></a><a name="underscoreToFunction"></a><span class='comment'>-- | Lowercases the first letter to make a valid function.</span>
<a name="(line11)"></a><span class='varid'>underscoreToFunction</span> <span class='conid'>[]</span> <span class='keyglyph'>=</span> <span class='varid'>error</span> <span class='str'>"toFunction passed an empty string"</span>
<a name="(line12)"></a><span class='varid'>underscoreToFunction</span> <span class='layout'>(</span><span class='varid'>firstL</span><span class='conop'>:</span><span class='varid'>ls</span><span class='layout'>)</span> <span class='keyglyph'>=</span> <span class='layout'>(</span><span class='conid'>Data</span><span class='varop'>.</span><span class='conid'>Char</span><span class='varop'>.</span><span class='varid'>toLower</span> <span class='varid'>firstL</span><span class='layout'>)</span> <span class='conop'>:</span> <span class='varid'>fromUnderscore</span> <span class='varid'>ls</span>
<a name="(line13)"></a>
<a name="(line14)"></a>
<a name="(line15)"></a><a name="underscoreToType"></a><span class='comment'>-- | Uppercases the first letter to make a valid type.</span>
<a name="(line16)"></a><span class='varid'>underscoreToType</span> <span class='conid'>[]</span> <span class='keyglyph'>=</span> <span class='varid'>error</span> <span class='str'>"toType passed an empty string"</span>
<a name="(line17)"></a><span class='varid'>underscoreToType</span> <span class='varid'>l</span> <span class='keyglyph'>=</span> <span class='varid'>fromUnderscore</span> <span class='varid'>l</span>
<a name="(line18)"></a>
<a name="(line19)"></a><a name="toUnderscore"></a><span class='comment'>-- | Convert AbbaDing to abba_ding</span>
<a name="(line20)"></a><span class='varid'>toUnderscore</span> <span class='conid'>[]</span> <span class='keyglyph'>=</span> <span class='varid'>error</span> <span class='str'>"toUnderscore passed an empty string"</span>
<a name="(line21)"></a><span class='varid'>toUnderscore</span> <span class='layout'>(</span><span class='varid'>l</span><span class='conop'>:</span><span class='varid'>ls</span><span class='layout'>)</span> <span class='keyglyph'>=</span> <span class='varid'>toLower</span> <span class='varid'>l</span> <span class='conop'>:</span> <span class='varid'>worker</span> <span class='varid'>ls</span>
<a name="(line22)"></a>  <span class='keyword'>where</span> <span class='varid'>worker</span> <span class='conid'>[]</span> <span class='keyglyph'>=</span> <span class='conid'>[]</span>
<a name="(line23)"></a>        <span class='varid'>worker</span> <span class='str'>"_"</span>        <span class='keyglyph'>=</span> <span class='str'>"_"</span> <span class='comment'>-- end with "_", then end with "_"</span>
<a name="(line24)"></a>        <span class='varid'>worker</span> <span class='layout'>(</span><span class='varid'>c</span><span class='conop'>:</span><span class='varid'>cs</span><span class='layout'>)</span>     <span class='keyglyph'>|</span> <span class='varid'>isUpper</span> <span class='varid'>c</span>  <span class='keyglyph'>=</span> <span class='chr'>'_'</span> <span class='conop'>:</span> <span class='varid'>toLower</span> <span class='varid'>c</span> <span class='conop'>:</span> <span class='varid'>worker</span> <span class='varid'>cs</span>
<a name="(line25)"></a>                          <span class='keyglyph'>|</span> <span class='varid'>otherwise</span>  <span class='keyglyph'>=</span> <span class='varid'>c</span> <span class='conop'>:</span> <span class='varid'>worker</span> <span class='varid'>cs</span>
<a name="(line26)"></a>
<a name="(line27)"></a><a name="fromUnderscore"></a><span class='comment'>-- | Convert abba_ding to AbbaDing</span>
<a name="(line28)"></a><span class='varid'>fromUnderscore</span> <span class='conid'>[]</span> <span class='keyglyph'>=</span> <span class='varid'>error</span> <span class='str'>"fromUnderscore passed an empty string"</span>
<a name="(line29)"></a><span class='varid'>fromUnderscore</span> <span class='layout'>(</span><span class='varid'>l</span><span class='conop'>:</span><span class='varid'>ls</span><span class='layout'>)</span> <span class='keyglyph'>=</span> <span class='varid'>toUpper</span> <span class='varid'>l</span> <span class='conop'>:</span> <span class='varid'>worker</span> <span class='varid'>ls</span>
<a name="(line30)"></a>  <span class='keyword'>where</span> <span class='varid'>worker</span> <span class='conid'>[]</span> <span class='keyglyph'>=</span> <span class='conid'>[]</span>
<a name="(line31)"></a>        <span class='varid'>worker</span>  <span class='str'>"_"</span>       <span class='keyglyph'>=</span> <span class='str'>"_"</span> <span class='comment'>-- end with "_", then end with "_"</span>
<a name="(line32)"></a>        <span class='varid'>worker</span> <span class='layout'>(</span><span class='chr'>'_'</span><span class='conop'>:</span><span class='varid'>c</span><span class='conop'>:</span><span class='varid'>cs</span><span class='layout'>)</span> <span class='keyglyph'>|</span> <span class='varid'>isLetter</span> <span class='varid'>c</span> <span class='keyglyph'>=</span> <span class='varid'>toUpper</span> <span class='varid'>c</span> <span class='conop'>:</span> <span class='varid'>worker</span> <span class='varid'>cs</span>
<a name="(line33)"></a>                          <span class='keyglyph'>|</span> <span class='varid'>otherwise</span>  <span class='keyglyph'>=</span> <span class='chr'>'_'</span>   <span class='conop'>:</span> <span class='varid'>c</span> <span class='conop'>:</span> <span class='varid'>worker</span> <span class='varid'>cs</span>
<a name="(line34)"></a>        <span class='varid'>worker</span> <span class='layout'>(</span><span class='varid'>c</span><span class='conop'>:</span><span class='varid'>cs</span><span class='layout'>)</span>     <span class='keyglyph'>=</span> <span class='varid'>c</span> <span class='conop'>:</span> <span class='varid'>worker</span> <span class='varid'>cs</span>
<a name="(line35)"></a>
</pre></body>
</html>
