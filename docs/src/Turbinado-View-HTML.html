<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://www.cs.york.ac.uk/fp/darcs/hscolour/ -->
<title>Haskell Code by HsColour</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="(line1)"></a><span class='keyword'>module</span> <span class='conid'>Turbinado</span><span class='varop'>.</span><span class='conid'>View</span><span class='varop'>.</span><span class='conid'>HTML</span> <span class='keyword'>where</span>
<a name="(line2)"></a>
<a name="(line3)"></a><span class='keyword'>import</span> <span class='conid'>Control</span><span class='varop'>.</span><span class='conid'>Monad</span>
<a name="(line4)"></a><span class='keyword'>import</span> <span class='conid'>Turbinado</span><span class='varop'>.</span><span class='conid'>View</span><span class='varop'>.</span><span class='conid'>Monad</span>
<a name="(line5)"></a><span class='keyword'>import</span> <span class='keyword'>qualified</span> <span class='conid'>Text</span><span class='varop'>.</span><span class='conid'>XHtml</span><span class='varop'>.</span><span class='conid'>Strict</span> <span class='keyword'>as</span> <span class='conid'>X</span>
<a name="(line6)"></a>
<a name="(line7)"></a><a name="VHtml"></a><span class='keyword'>type</span> <span class='conid'>VHtml</span> <span class='keyglyph'>=</span> <span class='conid'>View</span> <span class='conid'>X</span><span class='varop'>.</span><span class='conid'>Html</span>
<a name="(line8)"></a>
<a name="(line9)"></a><a name="VHTML"></a><span class='keyword'>class</span> <span class='conid'>VHTML</span> <span class='varid'>a</span> <span class='keyword'>where</span>
<a name="(line10)"></a>  <span class='varid'>toVHtml</span> <span class='keyglyph'>::</span> <span class='varid'>a</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>VHtml</span>
<a name="(line11)"></a>  <span class='varid'>toVHtmlFromList</span> <span class='keyglyph'>::</span> <span class='keyglyph'>[</span><span class='varid'>a</span><span class='keyglyph'>]</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>VHtml</span>
<a name="(line12)"></a>  <span class='varid'>toVHtmlFromList</span> <span class='varid'>xs</span> <span class='keyglyph'>=</span> <span class='keyword'>do</span> <span class='varid'>xs'</span> <span class='keyglyph'>&lt;-</span> <span class='varid'>mapM</span> <span class='varid'>toVHtml</span> <span class='varid'>xs</span>
<a name="(line13)"></a>                          <span class='varid'>return</span> <span class='varop'>$</span> <span class='conid'>X</span><span class='varop'>.</span><span class='varid'>concatHtml</span> <span class='varid'>xs'</span>
<a name="(line14)"></a>
<a name="(line15)"></a><span class='keyword'>instance</span> <span class='conid'>VHTML</span> <span class='conid'>X</span><span class='varop'>.</span><span class='conid'>Html</span> <span class='keyword'>where</span>
<a name="(line16)"></a>      <span class='varid'>toVHtml</span>    <span class='keyglyph'>=</span> <span class='varid'>return</span>
<a name="(line17)"></a>
<a name="(line18)"></a><span class='keyword'>instance</span> <span class='conid'>VHTML</span> <span class='conid'>VHtml</span> <span class='keyword'>where</span>
<a name="(line19)"></a>      <span class='varid'>toVHtml</span> <span class='varid'>v</span> <span class='keyglyph'>=</span> <span class='varid'>v</span>
<a name="(line20)"></a>
<a name="(line21)"></a><span class='keyword'>instance</span> <span class='conid'>VHTML</span> <span class='conid'>Char</span> <span class='keyword'>where</span>
<a name="(line22)"></a>      <span class='varid'>toVHtml</span>       <span class='varid'>a</span> <span class='keyglyph'>=</span> <span class='varid'>return</span> <span class='varop'>$</span> <span class='conid'>X</span><span class='varop'>.</span><span class='varid'>toHtml</span> <span class='keyglyph'>[</span><span class='varid'>a</span><span class='keyglyph'>]</span>
<a name="(line23)"></a>      <span class='varid'>toVHtmlFromList</span> <span class='keyglyph'>=</span> <span class='varid'>return</span> <span class='varop'>.</span> <span class='conid'>X</span><span class='varop'>.</span><span class='varid'>toHtmlFromList</span>
<a name="(line24)"></a>
<a name="(line25)"></a><span class='keyword'>instance</span> <span class='layout'>(</span><span class='conid'>VHTML</span> <span class='varid'>a</span><span class='layout'>)</span> <span class='keyglyph'>=&gt;</span> <span class='conid'>VHTML</span> <span class='keyglyph'>[</span><span class='varid'>a</span><span class='keyglyph'>]</span> <span class='keyword'>where</span>
<a name="(line26)"></a>      <span class='varid'>toVHtml</span> <span class='keyglyph'>=</span> <span class='varid'>toVHtmlFromList</span>
<a name="(line27)"></a>
<a name="(line28)"></a><span class='keyword'>instance</span> <span class='conid'>VHTML</span> <span class='varid'>a</span> <span class='keyglyph'>=&gt;</span> <span class='conid'>VHTML</span> <span class='layout'>(</span><span class='conid'>Maybe</span> <span class='varid'>a</span><span class='layout'>)</span> <span class='keyword'>where</span>
<a name="(line29)"></a>      <span class='varid'>toVHtml</span> <span class='varid'>m</span> <span class='keyglyph'>=</span> <span class='varid'>maybe</span> <span class='varid'>noVHtml</span> <span class='varid'>toVHtml</span> <span class='varid'>m</span>
<a name="(line30)"></a>
<a name="(line31)"></a>
<a name="(line32)"></a><a name="ADDATTRS"></a><span class='keyword'>class</span> <span class='conid'>ADDATTRS</span> <span class='varid'>a</span> <span class='keyword'>where</span>
<a name="(line33)"></a>      <span class='layout'>(</span><span class='varop'>!</span><span class='layout'>)</span> <span class='keyglyph'>::</span> <span class='varid'>a</span> <span class='keyglyph'>-&gt;</span> <span class='keyglyph'>[</span><span class='conid'>X</span><span class='varop'>.</span><span class='conid'>HtmlAttr</span><span class='keyglyph'>]</span> <span class='keyglyph'>-&gt;</span> <span class='varid'>a</span>
<a name="(line34)"></a>
<a name="(line35)"></a><span class='keyword'>instance</span> <span class='layout'>(</span><span class='conid'>ADDATTRS</span> <span class='varid'>b</span><span class='layout'>)</span> <span class='keyglyph'>=&gt;</span> <span class='conid'>ADDATTRS</span> <span class='layout'>(</span><span class='varid'>a</span> <span class='keyglyph'>-&gt;</span> <span class='varid'>b</span><span class='layout'>)</span> <span class='keyword'>where</span>
<a name="(line36)"></a>      <span class='varid'>fn</span> <span class='varop'>!</span> <span class='varid'>attr</span> <span class='keyglyph'>=</span> <span class='keyglyph'>\</span> <span class='varid'>arg</span> <span class='keyglyph'>-&gt;</span> <span class='varid'>fn</span> <span class='varid'>arg</span> <span class='varop'>!</span> <span class='varid'>attr</span>
<a name="(line37)"></a>
<a name="(line38)"></a><span class='keyword'>instance</span> <span class='conid'>ADDATTRS</span> <span class='conid'>VHtml</span> <span class='keyword'>where</span>
<a name="(line39)"></a>      <span class='varid'>vh</span> <span class='varop'>!</span> <span class='varid'>attr</span> <span class='keyglyph'>=</span> <span class='keyword'>do</span> <span class='varid'>vh'</span> <span class='keyglyph'>&lt;-</span> <span class='varid'>vh</span>
<a name="(line40)"></a>                     <span class='varid'>return</span> <span class='varop'>$</span> <span class='varid'>vh'</span> <span class='conid'>X</span><span class='varop'>.!</span> <span class='varid'>attr</span>
<a name="(line41)"></a>
<a name="(line42)"></a><span class='comment'>-- </span>
<a name="(line43)"></a><span class='comment'>-- * Html primitives and basic combinators</span>
<a name="(line44)"></a><span class='comment'>--</span>
<a name="(line45)"></a>
<a name="(line46)"></a><a name="<<"></a><span class='comment'>-- | Put something inside an HTML element.</span>
<a name="(line47)"></a><span class='layout'>(</span><span class='varop'>&lt;&lt;</span><span class='layout'>)</span> <span class='keyglyph'>::</span> <span class='layout'>(</span><span class='conid'>VHTML</span> <span class='varid'>a</span><span class='layout'>)</span> <span class='keyglyph'>=&gt;</span> 
<a name="(line48)"></a>        <span class='layout'>(</span><span class='conid'>VHtml</span> <span class='keyglyph'>-&gt;</span> <span class='varid'>b</span><span class='layout'>)</span> <span class='comment'>-- ^ Parent</span>
<a name="(line49)"></a>     <span class='keyglyph'>-&gt;</span> <span class='varid'>a</span> <span class='comment'>-- ^ Child</span>
<a name="(line50)"></a>     <span class='keyglyph'>-&gt;</span> <span class='varid'>b</span>
<a name="(line51)"></a><a name="fn"></a><span class='varid'>fn</span> <span class='varop'>&lt;&lt;</span> <span class='varid'>arg</span> <span class='keyglyph'>=</span> <span class='varid'>fn</span> <span class='layout'>(</span><span class='varid'>toVHtml</span> <span class='varid'>arg</span><span class='layout'>)</span> 
<a name="(line52)"></a>
<a name="(line53)"></a>
<a name="(line54)"></a><a name="concatVHtml"></a><span class='varid'>concatVHtml</span> <span class='keyglyph'>::</span> <span class='layout'>(</span><span class='conid'>VHTML</span> <span class='varid'>a</span><span class='layout'>)</span> <span class='keyglyph'>=&gt;</span> <span class='keyglyph'>[</span><span class='varid'>a</span><span class='keyglyph'>]</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>VHtml</span>
<a name="(line55)"></a><span class='varid'>concatVHtml</span> <span class='keyword'>as</span> <span class='keyglyph'>=</span> <span class='keyword'>do</span> <span class='varid'>hs</span> <span class='keyglyph'>&lt;-</span> <span class='varid'>sequence</span> <span class='varop'>$</span> <span class='varid'>map</span> <span class='varid'>toVHtml</span> <span class='keyword'>as</span>
<a name="(line56)"></a>                    <span class='varid'>return</span> <span class='varop'>$</span> <span class='conid'>X</span><span class='varop'>.</span><span class='varid'>concatHtml</span> <span class='varid'>hs</span> 
<a name="(line57)"></a>
<a name="(line58)"></a><a name="+++"></a><span class='comment'>-- | Create a piece of HTML which is the concatenation</span>
<a name="(line59)"></a><span class='comment'>--   of two things which can be made into HTML.</span>
<a name="(line60)"></a><span class='layout'>(</span><span class='varop'>+++</span><span class='layout'>)</span> <span class='keyglyph'>::</span> <span class='layout'>(</span><span class='conid'>VHTML</span> <span class='varid'>a</span><span class='layout'>,</span><span class='conid'>VHTML</span> <span class='varid'>b</span><span class='layout'>)</span> <span class='keyglyph'>=&gt;</span> <span class='varid'>a</span> <span class='keyglyph'>-&gt;</span> <span class='varid'>b</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>VHtml</span>
<a name="(line61)"></a><a name="a"></a><span class='varid'>a</span> <span class='varop'>+++</span> <span class='varid'>b</span> <span class='keyglyph'>=</span> <span class='keyword'>do</span> <span class='varid'>a'</span> <span class='keyglyph'>&lt;-</span> <span class='varid'>toVHtml</span> <span class='varid'>a</span>
<a name="(line62)"></a>             <span class='varid'>b'</span> <span class='keyglyph'>&lt;-</span> <span class='varid'>toVHtml</span> <span class='varid'>b</span>
<a name="(line63)"></a>             <span class='varid'>return</span> <span class='varop'>$</span> <span class='varid'>a'</span> <span class='conid'>X</span><span class='varop'>.+++</span> <span class='varid'>b'</span>
<a name="(line64)"></a>
<a name="(line65)"></a><a name="noVHtml"></a><span class='comment'>-- | An empty piece of HTML.</span>
<a name="(line66)"></a><span class='varid'>noVHtml</span> <span class='keyglyph'>::</span> <span class='conid'>VHtml</span>
<a name="(line67)"></a><span class='varid'>noVHtml</span> <span class='keyglyph'>=</span> <span class='varid'>return</span> <span class='varop'>$</span> <span class='conid'>X</span><span class='varop'>.</span><span class='varid'>noHtml</span>
<a name="(line68)"></a>
<a name="(line69)"></a><a name="tag"></a><span class='comment'>-- | Constructs an element with a custom name.</span>
<a name="(line70)"></a><span class='varid'>tag</span> <span class='keyglyph'>::</span> <span class='conid'>String</span> <span class='comment'>-- ^ Element name</span>
<a name="(line71)"></a>    <span class='keyglyph'>-&gt;</span> <span class='conid'>VHtml</span> <span class='comment'>-- ^ Element contents</span>
<a name="(line72)"></a>    <span class='keyglyph'>-&gt;</span> <span class='conid'>VHtml</span>
<a name="(line73)"></a><span class='varid'>tag</span> <span class='varid'>str</span> <span class='varid'>htmls</span> <span class='keyglyph'>=</span> <span class='keyword'>do</span> <span class='varid'>hs</span> <span class='keyglyph'>&lt;-</span> <span class='varid'>htmls</span>
<a name="(line74)"></a>                   <span class='varid'>return</span> <span class='varop'>$</span> <span class='conid'>X</span><span class='varop'>.</span><span class='varid'>tag</span> <span class='varid'>str</span> <span class='varid'>hs</span>
<a name="(line75)"></a>
<a name="(line76)"></a><a name="itag"></a><span class='comment'>-- | Constructs an element with a custom name, and</span>
<a name="(line77)"></a><span class='comment'>--   without any children.</span>
<a name="(line78)"></a><span class='varid'>itag</span> <span class='keyglyph'>::</span> <span class='conid'>String</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>VHtml</span>
<a name="(line79)"></a><span class='varid'>itag</span> <span class='varid'>str</span> <span class='keyglyph'>=</span> <span class='varid'>tag</span> <span class='varid'>str</span> <span class='varid'>noVHtml</span>
<a name="(line80)"></a><a name="stringToVHtml"></a><span class='varid'>stringToVHtml</span> <span class='keyglyph'>::</span> <span class='conid'>String</span> <span class='keyglyph'>-&gt;</span> <span class='conid'>VHtml</span>
<a name="(line81)"></a><span class='varid'>stringToVHtml</span> <span class='varid'>s</span> <span class='keyglyph'>=</span> <span class='varid'>return</span> <span class='varop'>$</span> <span class='conid'>X</span><span class='varop'>.</span><span class='varid'>stringToHtml</span> <span class='varid'>s</span>
<a name="(line82)"></a>
<a name="(line83)"></a><a name="emptyAttr"></a><span class='varid'>emptyAttr</span> <span class='keyglyph'>=</span> <span class='conid'>X</span><span class='varop'>.</span><span class='varid'>emptyAttr</span>
<a name="(line84)"></a><a name="intAttr"></a><span class='varid'>intAttr</span>  <span class='keyglyph'>=</span> <span class='conid'>X</span><span class='varop'>.</span><span class='varid'>intAttr</span>
<a name="(line85)"></a><a name="strAttr"></a><span class='varid'>strAttr</span> <span class='keyglyph'>=</span> <span class='conid'>X</span><span class='varop'>.</span><span class='varid'>strAttr</span>
<a name="(line86)"></a><a name="htmlAttr"></a><span class='varid'>htmlAttr</span>  <span class='keyglyph'>=</span> <span class='conid'>X</span><span class='varop'>.</span><span class='varid'>htmlAttr</span>
<a name="(line87)"></a>
<a name="(line88)"></a><span class='comment'>--prettyHtml = X.prettyHtml</span>
</pre></body>
</html>
